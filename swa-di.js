(function(){const CONFIG={DATA_COLLECTOR_URL:"/di/swadc/cdn/cs/pXS4eU1UtrsWT1A6lR5H5EQACPk.js",INTERCEPT_ENDPOINTS:["/api/","/account"],INTERCEPT_GET_ENDPOINTS:["resetPassQuestions"],INTERCEPT_FORM_POST:["/flight/login","/flight/account","/account/setup","/account/enroll","changeEmail","changeEmailSecQuestion","needUsername","answerSecurityUsername","answerSecurityChangeEmail","recovery","enroll-member","enroll-from-swabiz","resetPassQuestions","checkAvailability","SecurityZip","selectAccount","SecurityDoB"],MAX_EVENT_SIZE:1e4,SWA_TID_STORAGE_KEY:"SWA_TID"};function loadDataCollector(){try{const script=document.createElement("script");script.setAttribute("type","text/javascript");script.setAttribute("src",CONFIG.DATA_COLLECTOR_URL);script.setAttribute("dvct","500");script.setAttribute("id","bcn");script.setAttribute("dvc","l");script.onload=function(){if(!sessionStorage.getItem(CONFIG.SWA_TID_STORAGE_KEY)){if(window.hasOwnProperty("_bcn")&&window._bcn.hasOwnProperty("dvc")){const args={};args.callback=function(){window._bcn.dvc.submit(registeredCallBackMethod)};window._bcn.dvc.collect(args)}}};document.head.appendChild(script)}catch(err){}}function registeredCallBackMethod(){try{if(window.hasOwnProperty("_bcn")&&window._bcn.hasOwnProperty("dvc")){const transactionId=window._bcn.dvc?.getTID();sessionStorage.setItem(CONFIG.SWA_TID_STORAGE_KEY,transactionId)}}catch(err){}}function getDeviceTransactionId(){return sessionStorage.getItem(CONFIG.SWA_TID_STORAGE_KEY)}function collectEvents(){try{const events=window?._bcn?.getEvents();return events?.length<CONFIG.MAX_EVENT_SIZE?events:""}catch(err){}}function interceptXHR(){try{const oldXHROpen=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(method,url){oldXHROpen.apply(this,arguments);if(shouldInterceptCurrentApi(method,url)){this.setRequestHeader("x-swa-di-uid",window?._bcn?.getToken());this.setRequestHeader("x-swa-di-usid",window?._bcn?.getUbaSessionId());this.setRequestHeader("x-swa-di-pid",window?._bcn?.getPageId());this.setRequestHeader("x-swa-di-dtid",getDeviceTransactionId());this.setRequestHeader("x-swa-di-ue",collectEvents())}}}catch(err){}}function interceptFetch(){try{const originalFetch=window.fetch;window.fetch=function(url,options={}){options.headers=options.headers||{};if(shouldInterceptCurrentApi(options?.method,url)){options.headers["x-swa-di-uid"]=window?._bcn?.getToken();options.headers["x-swa-di-usid"]=window?._bcn?.getUbaSessionId();options.headers["x-swa-di-pid"]=window?._bcn?.getPageId();options.headers["x-swa-di-dtid"]=getDeviceTransactionId();options.headers["x-swa-di-ue"]=collectEvents()}return originalFetch(url,options)}}catch(err){}}function interceptFormPOST(){try{if(shouldInterceptFormPost()){document.addEventListener("DOMContentLoaded",function(){var forms=document.getElementsByTagName("form");for(var i=0;i<forms.length;i++){forms[i].addEventListener("submit",function(event){if(event.target.method.toLowerCase()==="post"){if(window.hasOwnProperty("_bcn")){window._bcn.flush()}this.appendChild(createInputElement("x-swa-di-uid",window?._bcn?.getToken()));this.appendChild(createInputElement("x-swa-di-usid",window?._bcn?.getUbaSessionId()));this.appendChild(createInputElement("x-swa-di-pid",window?._bcn?.getPageId()));this.appendChild(createInputElement("x-swa-di-dtid",getDeviceTransactionId()));this.appendChild(createInputElement("x-swa-di-ue",collectEvents()))}})}})}}catch(err){}}function createInputElement(paramName,paramValue){if(document.getElementsByName(paramName)?.length===0){const element=document.createElement("input");element.setAttribute("type","hidden");element.setAttribute("name",paramName);element.setAttribute("value",paramValue);return element}}function shouldInterceptCurrentApi(method,currentApiUrl){try{return method?.toLowerCase()!=="get"&&CONFIG.INTERCEPT_ENDPOINTS.some(endpoint=>currentApiUrl.includes(endpoint))||method?.toLowerCase()==="get"&&CONFIG.INTERCEPT_GET_ENDPOINTS.some(endpoint=>currentApiUrl.includes(endpoint))}catch(err){}}function shouldInterceptFormPost(){try{const currentPageUrl=window.location.href.split("?")[0];return CONFIG.INTERCEPT_FORM_POST.some(pageUrl=>currentPageUrl.includes(pageUrl))}catch(err){}}function init(){try{loadDataCollector();interceptXHR();interceptFetch();interceptFormPOST()}catch(err){}}init()})();